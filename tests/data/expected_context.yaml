# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

segmentItems:
  - serviceName: skywalking-agent-test-1
    segmentSize: 10
    segments:
      - segmentId: "not null"
        spans:
          - operationName: GET:/index.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /index.php }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
            refs:
              - {
                  parentEndpoint: /index.php,
                  networkAddress: "127.0.0.1:9011",
                  refType: CrossProcess,
                  parentSpanId: 1,
                  parentTraceSegmentId: "not null",
                  parentServiceInstance: "not null",
                  parentService: skywalking-agent-test-1,
                  traceId: "not null",
                }
      - segmentId: "not null"
        spans:
          - operationName: POST:/curl.test.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /curl.test.php }
              - { key: http.method, value: POST }
              - { key: http.status_code, value: "200" }
            refs:
              - {
                  parentEndpoint: /curl.test.php,
                  networkAddress: "127.0.0.1:9011",
                  refType: CrossProcess,
                  parentSpanId: 2,
                  parentTraceSegmentId: "not null",
                  parentServiceInstance: "not null",
                  parentService: skywalking-agent-test-1,
                  traceId: "not null",
                }
      - segmentId: "not null"
        spans:
          - operationName: POST:/curl.test.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /curl.test.php }
              - { key: http.method, value: POST }
              - { key: http.status_code, value: "200" }
            refs:
              - {
                  parentEndpoint: /curl.test.php,
                  networkAddress: "127.0.0.1:9011",
                  refType: CrossProcess,
                  parentSpanId: 3,
                  parentTraceSegmentId: "not null",
                  parentServiceInstance: "not null",
                  parentService: skywalking-agent-test-1,
                  traceId: "not null",
                }
      - segmentId: "not null"
        spans:
          - operationName: GET:/not-exists.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: true
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /not-exists.php }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "404" }
            refs:
              - {
                  parentEndpoint: /not-exists.php,
                  networkAddress: "127.0.0.1:9011",
                  refType: CrossProcess,
                  parentSpanId: 4,
                  parentTraceSegmentId: "not null",
                  parentServiceInstance: "not null",
                  parentService: skywalking-agent-test-1,
                  traceId: "not null",
                }
      - segmentId: "not null"
        spans:
          - operationName: GET:/index.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /index.php }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
            refs:
              - {
                  parentEndpoint: /index.php,
                  networkAddress: "127.0.0.1:9011",
                  refType: CrossProcess,
                  parentSpanId: 1,
                  parentTraceSegmentId: "not null",
                  parentServiceInstance: "not null",
                  parentService: skywalking-agent-test-2,
                  traceId: "not null",
                }
      - segmentId: "not null"
        spans:
          - operationName: /index.php
            parentSpanId: 0
            spanId: 1
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8002
            isError: false
            spanType: Exit
            peer: 127.0.0.1:9011
            skipAnalysis: false
            tags:
              - { key: url, value: "http://127.0.0.1:9011/index.php" }
              - { key: status_code, value: "200" }
          - operationName: /curl.test.php
            parentSpanId: 0
            spanId: 2
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8002
            isError: false
            spanType: Exit
            peer: 127.0.0.1:9011
            skipAnalysis: false
            tags:
              - { key: url, value: "http://127.0.0.1:9011/curl.test.php" }
              - { key: status_code, value: "200" }
          - operationName: /curl.test.php
            parentSpanId: 0
            spanId: 3
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8002
            isError: false
            spanType: Exit
            peer: 127.0.0.1:9011
            skipAnalysis: false
            tags:
              - { key: url, value: "http://127.0.0.1:9011/curl.test.php" }
              - { key: status_code, value: "200" }
          - operationName: /not-exists.php
            parentSpanId: 0
            spanId: 4
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8002
            isError: true
            spanType: Exit
            peer: 127.0.0.1:9011
            skipAnalysis: false
            tags:
              - { key: url, value: "http://127.0.0.1:9011/not-exists.php" }
              - { key: status_code, value: "500" }
          - operationName: /guzzle.php
            parentSpanId: 0
            spanId: 5
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8002
            isError: false
            spanType: Exit
            peer: 127.0.0.1:9012
            skipAnalysis: false
            tags:
              - { key: url, value: "http://127.0.0.1:9012/guzzle.php" }
              - { key: status_code, value: "200" }
          - operationName: GET:/curl.enter.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /curl.enter.php }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
      - segmentId: "not null"
        spans:
          - operationName: PDO->exec
            parentSpanId: 0
            spanId: 1
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                  key: db.data_source,
                  value: "dbname=skywalking;host=127.0.0.1;port=3306",
                }
              - { key: db.statement, value: SELECT 1 }
          - operationName: PDO->prepare
            parentSpanId: 0
            spanId: 2
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                  key: db.data_source,
                  value: "dbname=skywalking;host=127.0.0.1:3306",
                }
              - {
                  key: db.statement,
                  value: "SELECT * FROM `mysql`.`user` WHERE `User` = :user",
                }
          - operationName: PDOStatement->execute
            parentSpanId: 0
            spanId: 3
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                  key: db.data_source,
                  value: "dbname=skywalking;host=127.0.0.1:3306",
                }
              - {
                  key: db.statement,
                  value: "SELECT * FROM `mysql`.`user` WHERE `User` = :user",
                }
          - operationName: PDOStatement->fetchAll
            parentSpanId: 0
            spanId: 4
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                  key: db.data_source,
                  value: "dbname=skywalking;host=127.0.0.1:3306",
                }
              - {
                  key: db.statement,
                  value: "SELECT * FROM `mysql`.`user` WHERE `User` = :user",
                }
          - operationName: PDO->prepare
            parentSpanId: 0
            spanId: 5
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                key: db.data_source,
                value: "dbname=skywalking;host=127.0.0.1:3306;",
              }
              - {
                key: db.statement,
                value: "SELECT * FROM `mysql`.`user` WHERE `User` = :user",
              }
          - operationName: PDOStatement->execute
            parentSpanId: 0
            spanId: 6
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                key: db.data_source,
                value: "dbname=skywalking;host=127.0.0.1:3306;",
              }
              - {
                key: db.statement,
                value: "SELECT * FROM `mysql`.`user` WHERE `User` = :user",
              }
          - operationName: PDOStatement->fetchAll
            parentSpanId: 0
            spanId: 7
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                key: db.data_source,
                value: "dbname=skywalking;host=127.0.0.1:3306;",
              }
              - {
                key: db.statement,
                value: "SELECT * FROM `mysql`.`user` WHERE `User` = :user",
              }
          - operationName: PDO->prepare
            parentSpanId: 0
            spanId: 8
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                key: db.data_source,
                value: "dbname=skywalking;host=127.0.0.1;port=3306",
              }
              - {
                key: db.statement,
                value: "SELECT * FROM not_exist",
              }
          - operationName: PDOStatement->execute
            parentSpanId: 0
            spanId: 9
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8003
            isError: true
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - { key: db.type, value: mysql }
              - {
                key: db.data_source,
                value: "dbname=skywalking;host=127.0.0.1;port=3306",
              }
              - {
                key: db.statement,
                value: "SELECT * FROM not_exist",
              }
            logs:
              - logEvent:
                - { key: SQLSTATE, value: 42S02 }
                - { key: Error Code, value: '1146' }
                - { key: Error, value: "Table 'skywalking.not_exist' doesn't exist" }
          - operationName: GET:/pdo.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /pdo.php }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
      - segmentId: "not null"
        spans:
          - operationName: "Predis\\Connection\\AbstractConnection->AUTH"
            parentSpanId: 0
            spanId: 1
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 8006
            isError: false
            spanType: Exit
            peer: 127.0.0.1:6379
            skipAnalysis: false
            tags:
              - { key: db.type, value: redis }
              - { key: redis.command, value: AUTH password }
          - operationName: "Predis\\Connection\\AbstractConnection->SET"
            parentSpanId: 0
            spanId: 2
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 8006
            isError: false
            spanType: Exit
            peer: 127.0.0.1:6379
            skipAnalysis: false
            tags:
              - { key: db.type, value: redis }
              - { key: redis.command, value: SET foo bar }
          - operationName: "Predis\\Connection\\AbstractConnection->GET"
            parentSpanId: 0
            spanId: 3
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 8006
            isError: false
            spanType: Exit
            peer: 127.0.0.1:6379
            skipAnalysis: false
            tags:
              - { key: db.type, value: redis }
              - { key: redis.command, value: GET foo }
          - operationName: "Predis\\Connection\\AbstractConnection->GET"
            parentSpanId: 0
            spanId: 4
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 8006
            isError: true
            spanType: Exit
            peer: 127.0.0.1:6379
            skipAnalysis: false
            tags:
              - { key: db.type, value: redis }
              - { key: redis.command, value: GET not-exists }
          - operationName: GET:/predis.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /predis.php }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
      - segmentId: 'not null'
        spans:
          - operationName: mysqli->query
            parentSpanId: 0
            spanId: 1
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8004
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - {key: db.type, value: mysql}
              - {
                  key: db.statement,
                  value: "SELECT 1",
                }
          - operationName: mysqli->query
            parentSpanId: 0
            spanId: 2
            spanLayer: Database
            startTime: gt 0
            endTime: gt 0
            componentId: 8004
            isError: false
            spanType: Exit
            peer: 127.0.0.1:3306
            skipAnalysis: false
            tags:
              - {key: db.type, value: mysql}
              - {
                  key: db.statement,
                  value: "SELECT * FROM `mysql`.`user` WHERE `User` = 'root'",
                }
          - operationName: GET:/mysqli.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - {key: url, value: /mysqli.php}
              - {key: http.method, value: GET}
              - {key: http.status_code, value: '200'}
      - segmentId: 'not null'
        spans:
          - operationName: Memcached->addServer
            parentSpanId: 0
            spanId: 1
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 20
            isError: false
            spanType: Exit
            peer: ""
            skipAnalysis: false
            tags:
              - { key: db.type, value: memcached }
              - { key: memcached.command, value: addServer 127.0.0.1 11211 }
          - operationName: Memcached->set
            parentSpanId: 0
            spanId: 2
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 20
            isError: false
            spanType: Exit
            peer: 127.0.0.1:11211
            skipAnalysis: false
            tags:
              - { key: db.type, value: memcached }
              - { key: memcached.command, value: set foo Hello! }
          - operationName: Memcached->set
            parentSpanId: 0
            spanId: 3
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 20
            isError: false
            spanType: Exit
            peer: 127.0.0.1:11211
            skipAnalysis: false
            tags:
              - { key: db.type, value: memcached }
              - { key: memcached.command, value: set bar Memcached... }
          - operationName: Memcached->get
            parentSpanId: 0
            spanId: 4
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 20
            isError: false
            spanType: Exit
            peer: 127.0.0.1:11211
            skipAnalysis: false
            tags:
              - { key: db.type, value: memcached }
              - { key: memcached.command, value: get foo }
          - operationName: Memcached->get
            parentSpanId: 0
            spanId: 5
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 20
            isError: false
            spanType: Exit
            peer: 127.0.0.1:11211
            skipAnalysis: false
            tags:
              - { key: db.type, value: memcached }
              - { key: memcached.command, value: get bar }
          - operationName: Memcached->setMulti
            parentSpanId: 0
            spanId: 6
            spanLayer: Cache
            startTime: gt 0
            endTime: gt 0
            componentId: 20
            isError: false
            spanType: Exit
            peer: ""
            skipAnalysis: false
            tags:
              - { key: db.type, value: memcached }
              - {
                  key: memcached.command,
                  value:
                    'setMulti {"key1":"value1","key2":"value2","key3":"value3"}',
                }
          - operationName: GET:/memcached.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /memcached.php }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
  - serviceName: skywalking-agent-test-2
    segmentSize: 1
    segments:
      - segmentId: "not null"
        spans:
          - operationName: /index.php
            parentSpanId: 0
            spanId: 1
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8002
            isError: false
            spanType: Exit
            peer: 127.0.0.1:9011
            skipAnalysis: false
            tags:
              - { key: url, value: "http://127.0.0.1:9011/index.php" }
              - { key: status_code, value: "200" }
          - operationName: GET:/guzzle.php
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /guzzle.php }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
            refs:
              - {
                  parentEndpoint: /guzzle.php,
                  networkAddress: "127.0.0.1:9012",
                  refType: CrossProcess,
                  parentSpanId: 5,
                  parentTraceSegmentId: "not null",
                  parentServiceInstance: "not null",
                  parentService: skywalking-agent-test-1,
                  traceId: "not null",
                }
  - serviceName: skywalking-agent-test-1-swoole
    segmentSize: 2
    segments:
      - segmentId: "not null"
        spans:
          - operationName: GET:/
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: / }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
            refs:
              - {
                  parentEndpoint: /,
                  networkAddress: "127.0.0.1:9501",
                  refType: CrossProcess,
                  parentSpanId: 1,
                  parentTraceSegmentId: "not null",
                  parentServiceInstance: "not null",
                  parentService: skywalking-agent-test-1-swoole,
                  traceId: "not null",
                }
      - segmentId: "not null"
        spans:
          - operationName: /
            parentSpanId: 0
            spanId: 1
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8002
            isError: false
            spanType: Exit
            peer: 127.0.0.1:9501
            skipAnalysis: false
            tags:
              - { key: url, value: "http://127.0.0.1:9501/" }
              - { key: status_code, value: "200" }
          - operationName: /
            parentSpanId: 0
            spanId: 2
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8002
            isError: false
            spanType: Exit
            peer: 127.0.0.1:9502
            skipAnalysis: false
            tags:
              - { key: url, value: "http://127.0.0.1:9502/" }
              - { key: status_code, value: "200" }
          - operationName: GET:/curl
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: /curl }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
  - serviceName: skywalking-agent-test-2-swoole
    segmentSize: 1
    segments:
      - segmentId: "not null"
        spans:
          - operationName: GET:/
            parentSpanId: -1
            spanId: 0
            spanLayer: Http
            startTime: gt 0
            endTime: gt 0
            componentId: 8001
            isError: false
            spanType: Entry
            peer: ""
            skipAnalysis: false
            tags:
              - { key: url, value: / }
              - { key: http.method, value: GET }
              - { key: http.status_code, value: "200" }
            refs:
              - {
                  parentEndpoint: /,
                  networkAddress: "127.0.0.1:9502",
                  refType: CrossProcess,
                  parentSpanId: 2,
                  parentTraceSegmentId: "not null",
                  parentServiceInstance: "not null",
                  parentService: skywalking-agent-test-1-swoole,
                  traceId: "not null",
                }
